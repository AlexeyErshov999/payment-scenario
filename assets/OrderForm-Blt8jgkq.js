import{d as f,c as g,a as c,r as x,o as b,_ as h,b as I,m as P,u as i,e as w,f as E,g as B,h as m,w as y,F as C,i as D,j as $,k as O,l as q,n as V}from"./index-BlzT3XFt.js";import{p as R,f as k,F as p,c as U,a as j,e as N,d as A,S as M,v as T}from"./validationRules-BZb5Ckag.js";import"./messages-D5fpFi7l.js";const z={class:"center"},G={class:"center__inner"},H=f({__name:"PageContainer",props:{fullViewport:{type:Boolean}},setup(a){return(s,l)=>(b(),g("div",z,[c("div",G,[x(s.$slots,"default",{},void 0)])]))}}),J=h(H,[["__scopeId","data-v-e14d0f18"]]),K=f({__name:"PriceInput",props:{name:{},label:{},placeholder:{},icon:{},error:{},modelValue:{},required:{type:Boolean,default:!0},min:{default:0},max:{default:1/0},currency:{default:"₽"},showCurrency:{type:Boolean,default:!0}},emits:["update:modelValue","input"],setup(a){const s=a,l=w(()=>U(s.min,s.max,s.required));return(o,e)=>(b(),I(p,P({name:a.name,label:a.label,type:"text",placeholder:a.placeholder||"0",icon:a.icon,error:a.error,rules:l.value,"model-value":a.modelValue,formatter:i(k),parser:i(R),"onUpdate:modelValue":e[0]||(e[0]=u=>o.$emit("update:modelValue",u)),onInput:e[1]||(e[1]=u=>o.$emit("input",u))},o.$attrs,{class:"price-input"}),null,16,["name","label","placeholder","icon","error","rules","model-value","formatter","parser"]))}}),L={class:"form-actions"},Q=f({__name:"OrderForm",setup(a){localStorage.removeItem("orderData");const s=$(),l=E(),o=B(),e=q({amount:"",email:"",description:""}),u=V(!1),v=V(null),_=()=>{const n=T(e);if(!n.valid){for(const[r,d]of Object.entries(n.errors))l.addError(r,d);return null}return n.data},S=async()=>{u.value=!0,o.loading=!0,v.value=null;try{l.clearAllErrors();const n=document.querySelector('[name="amount"]'),r=document.querySelector('[name="email"]'),d=document.querySelector('[name="description"]');if(n?.blur(),r?.blur(),d?.blur(),l.hasErrors){console.log("Ошибки валидации:",l.allErrors);return}const t=_();if(!t)return;o.setOrderData(t),console.log("Заказ успешно создан:",t),await new Promise(F=>setTimeout(F,2e3)),await s.push("/payment")}catch(n){console.error("Ошибка при создании заказа:",n),v.value="Произошла ошибка при создании заказа. Пожалуйста, попробуйте снова."}finally{u.value=!1,o.loading=!1}};return(n,r)=>{const d=D("PaymentFooter");return b(),g(C,null,[m(J,null,{default:y(()=>[m(j,{"has-shadow":!0,title:"Создание заказа"},{default:y(()=>[c("form",{onSubmit:O(S,["prevent"]),class:"form"},[m(K,{modelValue:e.amount,"onUpdate:modelValue":r[0]||(r[0]=t=>e.amount=t),name:"amount",label:"Введите сумму заказа",placeholder:"0",icon:"₽",min:1,max:1e6},null,8,["modelValue"]),m(p,{modelValue:e.email,"onUpdate:modelValue":r[1]||(r[1]=t=>e.email=t),name:"email",label:"Email",type:"email",placeholder:"example@mail.com",rules:i(N)},null,8,["modelValue","rules"]),m(p,{modelValue:e.description,"onUpdate:modelValue":r[2]||(r[2]=t=>e.description=t),name:"description",label:"Описание",type:"text",placeholder:"Что-то о заказе","max-lines":3,rules:i(A),maxlength:"200"},null,8,["modelValue","rules"]),c("div",L,[m(M,{text:"Создать",type:"submit",disabled:u.value,"has-form-errors":i(l).hasErrors,loading:i(o).loading},null,8,["disabled","has-form-errors","loading"])])],32)]),_:1})]),_:1}),m(d,{"order-number":i(o).orderData?.orderId},null,8,["order-number"])],64)}}}),Z=h(Q,[["__scopeId","data-v-e9bdd0ee"]]);export{Z as default};
