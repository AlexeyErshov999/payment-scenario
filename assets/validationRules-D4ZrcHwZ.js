import{d as y,o as u,n as d,s as R,x as E,t as _,p as h,_ as x,f as O,h as I,j as S,b as U,B as b,z as M,l as w,y as k,F as P,q as L,C as B,D as H,E as X,m as G,c as Q,a as $}from"./index-dK2CgAWm.js";import{V as o}from"./messages-BGBza2Ci.js";const z={key:0,class:"card__logo"},Y={key:1,class:"card__title"},j=y({__name:"FormCard",props:{title:{},hasShadow:{type:Boolean}},setup(e){return(r,t)=>(u(),d("div",{class:h(["card",{"card--has-shadow":e.hasShadow}])},[r.$slots.logo?(u(),d("div",z,[R(r.$slots,"logo",{},void 0)])):E("",!0),e.title?(u(),d("h1",Y,_(e.title),1)):E("",!0),R(r.$slots,"default",{},void 0)],2))}}),Ne=x(j,[["__scopeId","data-v-4e6704f6"]]),q=["disabled"],J={key:0,class:"spinner"},K=y({__name:"SubmitButton",props:{text:{default:""},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},redirectTo:{default:""},hasFormErrors:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:r}){const t=e,n=r,s=O(),c=async a=>{if(!(t.disabled||t.loading))try{await n("click",a),t.redirectTo&&await s.push(t.redirectTo)}catch(f){console.error("Ошибка:",f)}};return(a,f)=>(u(),d("button",{class:h(["submit-button",{"is-loading":e.loading}]),disabled:e.disabled||e.hasFormErrors,onClick:c},[e.loading?(u(),d("span",J)):E("",!0),I("span",{class:h({"visually-hidden":e.loading})},_(e.text),3)],10,q))}}),De=x(K,[["__scopeId","data-v-ddb384bc"]]),W={key:0,class:"validation-error"},Z={key:1,class:"validation-error"},ee=y({__name:"ErrorMessage",props:{text:{}},setup(e){return(r,t)=>e.text?(u(),d("span",W,_(e.text),1)):r.$slots.default?(u(),d("span",Z,[R(r.$slots,"default",{},void 0)])):E("",!0)}}),te=x(ee,[["__scopeId","data-v-4c676112"]]),re={class:"input-wrapper"},ne={key:0,class:"input__label-inner"},se={class:"input__label-suffix"},ae=["placeholder","rows"],oe=["type","placeholder"],ie=["innerHTML"],le={class:"input__error-slot"},ce=y({__name:"FormInput",props:{name:{},label:{},type:{default:"text"},placeholder:{},icon:{},error:{},maxLines:{},rules:{},modelValue:{},formatter:{type:Function,default:e=>e},parser:{type:Function,default:e=>e}},emits:["update:modelValue","input"],setup(e,{emit:r}){const t=e,n=r,s=S(t.modelValue?.toString()||""),c=S(null),a=U(),f=$(()=>{if(t.error)return t.error;const i=a.allErrors[t.name];return i&&i.length>0?i[0]:void 0}),F=i=>{const l=i.target,m=l.selectionStart,g=l.value,p=t.parser(g),D=t.formatter(p);if(D!==g&&(l.value=D,m!==null)){const V=D.length-g.length;M(()=>{l.setSelectionRange(m+V,m+V)})}s.value=p,n("update:modelValue",p),n("input",p),(a.allErrors[t.name]||[]).length>0&&a.clearFieldErrors(t.name)},v=$({get:()=>t.formatter(s.value),set:i=>{const l=t.parser(i);s.value=l,n("update:modelValue",l),n("input",l),(a.allErrors[t.name]||[]).length>0&&a.clearFieldErrors(t.name)}}),A=()=>{if(a.clearFieldErrors(t.name),t.rules&&t.rules.length>0)for(const i of t.rules){const l=i(s.value);if(typeof l=="string"){a.addError(t.name,l);return}}},N=()=>{if(c.value&&t.maxLines&&t.maxLines>1){const i=c.value;i.style.height="auto";const g=t.maxLines*22+6,p=i.scrollHeight;i.style.height=Math.min(p,g)+"px",p>g?i.style.overflowY="auto":i.style.overflowY="hidden"}};return b(()=>t.modelValue,i=>{i!==void 0&&(s.value=i.toString())}),b(s,()=>{t.maxLines&&t.maxLines>1&&M(()=>{N()})}),b(()=>t.maxLines,()=>{t.maxLines&&t.maxLines>1&&c.value&&M(()=>{N()})},{immediate:!0}),w(()=>{a.clearFieldErrors(t.name)}),(i,l)=>(u(),d("div",re,[I("label",{class:h(["input__label",{"input__label--error":f.value}])},[i.$slots.labelSuffix?(u(),d("span",ne,[k(_(e.label)+" ",1),I("span",se,[R(i.$slots,"labelSuffix",{},void 0)])])):(u(),d(P,{key:1},[k(_(e.label),1)],64))],2),I("div",{class:h(["input-container",{"has-icon":e.icon}])},[e.maxLines&&e.maxLines>1?L((u(),d("textarea",{key:0,class:h(["input textarea",{"input--error":f.value}]),"onUpdate:modelValue":l[0]||(l[0]=m=>v.value=m),placeholder:e.placeholder,rows:e.maxLines,style:H({paddingRight:e.icon?"30px":"12px"}),onInput:N,onBlur:A,ref_key:"textareaRef",ref:c},null,46,ae)),[[B,v.value]]):L((u(),d("input",G({key:1,class:["input",{"input--error":f.value}],type:e.type,"onUpdate:modelValue":l[1]||(l[1]=m=>v.value=m),placeholder:e.placeholder,style:{paddingRight:e.icon?"30px":"12px"},onInput:F,onBlur:A},i.$attrs),null,16,oe)),[[X,v.value]]),e.icon?(u(),d("span",{key:2,class:h(["input__icon",{"input__icon--error":f.value}]),innerHTML:e.icon},null,10,ie)):E("",!0)],2),I("div",le,[f.value?(u(),Q(te,{key:0,text:f.value},null,8,["text"])):E("",!0)])]))}}),be=x(ce,[["__scopeId","data-v-7346106d"]]),ue=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,de=e=>ue.test(e),fe=e=>{const r=e.replace(/\D/g,"");return r?r.length!==16?o.CARD_LENGTH:me(r)?!0:o.CARD_INVALID:o.CARD_REQUIRED};function me(e){let r=0,t=!1;for(let n=e.length-1;n>=0;n--){let s=parseInt(e.charAt(n));t&&(s*=2,s>9&&(s-=9)),r+=s,t=!t}return r%10===0}const pe=(e,r,t,n,s)=>{const c=r(e);if(!c||!/^\d+$/.test(c))return o.AMOUNT_INTEGER;const a=Number(c);return Number.isInteger(a)?a<0?o.AMOUNT_NOT_NEGATIVE:a<n?o.AMOUNT_MIN(t(n.toString())):a>s?o.AMOUNT_MAX(t(s.toString())):!0:o.AMOUNT_INTEGER},he=(e,r)=>{const t=r(e);if(!t)return o.EXPIRE_REQUIRED;if(t.length!==4)return o.EXPIRE_FORMAT;const n=parseInt(t.slice(0,2),10);if(n<1||n>12)return o.EXPIRE_MONTH_INVALID;const s=parseInt(t.slice(2),10),c=new Date,a=c.getFullYear()%100,f=c.getMonth()+1;return s<a||s===a&&n<f?o.EXPIRE_EXPIRED:!0},ge=e=>{const r=e.replace(/\D/g,"");return r?r.length<3?o.CVV_MIN:!0:o.CVV_REQUIRED},C=(e,r={})=>{const{showCurrency:t=!1,currency:n="₽"}=r;if(!e)return"";const s=e.replace(/\D/g,"");if(!s)return"";const a=(s.replace(/^0+/,"")||"0").replace(/\B(?=(\d{3})+(?!\d))/g," ");return t?n+" "+a:a},Ee=(e,r={})=>{const{currency:t="₽"}=r;if(!e)return"";let n=e.replace(t,"").trim();return n=n.replace(/\s/g,""),n=n.replace(/\D/g,""),n},Me=(e,r={})=>{const t=Math.round(e);return C(t.toString(),r)},Ie=e=>e.replace(/\D/g,"").slice(0,4),Te=e=>{const r=e.replace(/\D/g,"").slice(0,4);return r.length<2?r:r.length===2?`${r} / `:`${r.slice(0,2)} / ${r.slice(2)}`},Ae=(e=0,r=1/0,t=!0)=>[n=>!n||!n.trim()?t?o.AMOUNT_REQUIRED:!0:pe(n,Ee,C,e,r)],_e=[e=>e?isNaN(Number(e))?o.AMOUNT_INTEGER:Number(e)<=0?o.AMOUNT_POSITIVE:!0:o.AMOUNT_REQUIRED],ve=[e=>e?de(e)?!0:o.EMAIL_INVALID:o.EMAIL_REQUIRED],Re=[e=>e?e.length<10?o.DESCRIPTION_MIN:e.length>500?o.DESCRIPTION_MAX:!0:o.DESCRIPTION_REQUIRED],Ve=[fe],Se=[e=>he(e,Ie)],ke=[ge],T=(e,r)=>{for(const t of r){const n=t(e);if(typeof n=="string")return n}return!0},Le=e=>{const r={},t=T(e.amount,_e);t!==!0&&(r.amount=t);const n=T(e.email.trim(),ve);n!==!0&&(r.email=n);const s=T(e.description.trim(),Re);if(s!==!0&&(r.description=s),Object.keys(r).length>0)return{valid:!1,errors:r};const c=e.amount.replace(/\s/g,"").replace(",",".");return{valid:!0,data:{amount:parseFloat(c),email:e.email.trim(),description:e.description.trim()}}};export{be as F,De as S,Ne as a,Ve as b,Ae as c,Re as d,ve as e,C as f,Ie as g,Te as h,Se as i,ke as j,Me as k,Ee as p,Le as v};
