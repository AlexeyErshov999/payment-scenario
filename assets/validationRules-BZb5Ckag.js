import{d as D,c as m,s as R,r as x,y as I,x as y,o as d,_ as N,a as _,j as O,n as F,f as U,C as V,q as B,A as k,F as H,t as M,D as G,m as L,E as X,b as Q,e as C,z as T}from"./index-BlzT3XFt.js";import{V as l}from"./messages-D5fpFi7l.js";const z={key:0,class:"card__logo"},Y={key:1,class:"card__title"},j=D({__name:"FormCard",props:{title:{},hasShadow:{type:Boolean}},setup(e){return(r,t)=>(d(),m("div",{class:R(["card",{"card--has-shadow":e.hasShadow}])},[r.$slots.logo?(d(),m("div",z,[x(r.$slots,"logo",{},void 0)])):I("",!0),e.title?(d(),m("h1",Y,y(e.title),1)):I("",!0),x(r.$slots,"default",{},void 0)],2))}}),Ne=N(j,[["__scopeId","data-v-d7e99fbf"]]),W=["disabled"],q={key:0,class:"spinner"},J=D({__name:"SubmitButton",props:{text:{default:""},loading:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},redirectTo:{default:""},hasFormErrors:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:r}){const t=e,n=r,s=O(),u=async i=>{if(!(t.disabled||t.loading))try{await n("click",i),t.redirectTo&&await s.push(t.redirectTo)}catch(o){console.error("Ошибка:",o)}};return(i,o)=>(d(),m("button",{class:R(["submit-button",{"is-loading":e.loading}]),disabled:e.disabled||e.hasFormErrors,onClick:u},[e.loading?(d(),m("span",q)):I("",!0),_("span",{class:R({"visually-hidden":e.loading})},y(e.text),3)],10,W))}}),be=N(J,[["__scopeId","data-v-ddb384bc"]]),K={key:0,class:"validation-error"},Z={key:1,class:"validation-error"},ee=D({__name:"ErrorMessage",props:{text:{}},setup(e){return(r,t)=>e.text?(d(),m("span",K,y(e.text),1)):r.$slots.default?(d(),m("span",Z,[x(r.$slots,"default",{},void 0)])):I("",!0)}}),te=N(ee,[["__scopeId","data-v-4c676112"]]),re={class:"input-wrapper"},ne={key:0,class:"input__label-inner"},se={class:"input__label-suffix"},ae=["placeholder","rows"],oe=["type","placeholder"],ie=["innerHTML"],le={class:"input__error-slot"},ce=D({__name:"FormInput",props:{name:{},label:{},type:{default:"text"},placeholder:{},icon:{},error:{},maxLines:{},rules:{},modelValue:{},formatter:{type:Function,default:e=>e},parser:{type:Function,default:e=>e}},emits:["update:modelValue","input"],setup(e,{emit:r}){const t=e,n=r,s=F(t.modelValue?.toString()||""),u=F(null),i=U(),o=C(()=>{if(t.error)return t.error;const a=i.allErrors[t.name];return a&&a.length>0?a[0]:void 0}),E=a=>{const c=a.target,p=c.selectionStart,v=c.value,h=t.parser(v),$=t.formatter(h);if($!==v&&(c.value=$,p!==null)){const A=$.length-v.length;T(()=>{c.setSelectionRange(p+A,p+A)})}s.value=h,n("update:modelValue",h),n("input",h),(i.allErrors[t.name]||[]).length>0&&i.clearFieldErrors(t.name)},g=C({get:()=>t.formatter(s.value),set:a=>{const c=t.parser(a);s.value=c,n("update:modelValue",c),n("input",c),(i.allErrors[t.name]||[]).length>0&&i.clearFieldErrors(t.name)}}),b=()=>{if(i.clearFieldErrors(t.name),t.rules&&t.rules.length>0)for(const a of t.rules){const c=a(s.value);if(typeof c=="string"){i.addError(t.name,c);return}}},f=()=>{if(u.value&&t.maxLines&&t.maxLines>1){const a=u.value;a.style.height="auto";const v=t.maxLines*22+6,h=a.scrollHeight;a.style.height=Math.min(h,v)+"px",h>v?a.style.overflowY="auto":a.style.overflowY="hidden"}};return V(()=>t.modelValue,a=>{a!==void 0&&(s.value=a.toString())}),V(s,()=>{t.maxLines&&t.maxLines>1&&T(()=>{f()})}),V(()=>t.maxLines,()=>{t.maxLines&&t.maxLines>1&&u.value&&T(()=>{f()})},{immediate:!0}),B(()=>{i.clearFieldErrors(t.name)}),(a,c)=>(d(),m("div",re,[_("label",{class:R(["input__label",{"input__label--error":o.value}])},[a.$slots.labelSuffix?(d(),m("span",ne,[k(y(e.label)+" ",1),_("span",se,[x(a.$slots,"labelSuffix",{},void 0)])])):(d(),m(H,{key:1},[k(y(e.label),1)],64))],2),_("div",{class:R(["input-container",{"has-icon":e.icon}])},[e.maxLines&&e.maxLines>1?M((d(),m("textarea",L({key:0,class:["input textarea",{"input--error":o.value}],"onUpdate:modelValue":c[0]||(c[0]=p=>g.value=p),placeholder:e.placeholder,rows:e.maxLines,style:{paddingRight:e.icon?"30px":"12px"},onInput:f,onBlur:b,ref_key:"textareaRef",ref:u},a.$attrs),null,16,ae)),[[G,g.value]]):M((d(),m("input",L({key:1,class:["input",{"input--error":o.value}],type:e.type,"onUpdate:modelValue":c[1]||(c[1]=p=>g.value=p),placeholder:e.placeholder,style:{paddingRight:e.icon?"30px":"12px"},onInput:E,onBlur:b},a.$attrs),null,16,oe)),[[X,g.value]]),e.icon?(d(),m("span",{key:2,class:R(["input__icon",{"input__icon--error":o.value}]),innerHTML:e.icon},null,10,ie)):I("",!0)],2),_("div",le,[o.value?(d(),Q(te,{key:0,text:o.value},null,8,["text"])):I("",!0)])]))}}),$e=N(ce,[["__scopeId","data-v-52001af9"]]),ue=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,de=e=>ue.test(e),me=e=>{const r=e.replace(/\D/g,"");return r?r.length!==16?l.CARD_LENGTH:fe(r)?!0:l.CARD_INVALID:l.CARD_REQUIRED};function fe(e){let r=0,t=!1;for(let n=e.length-1;n>=0;n--){let s=parseInt(e.charAt(n));t&&(s*=2,s>9&&(s-=9)),r+=s,t=!t}return r%10===0}const pe=(e,r,t,n,s)=>{const u=r(e);if(!u)return l.AMOUNT_INTEGER;const i=u.replace(",","."),o=Number(i);if(!Number.isFinite(o))return l.AMOUNT_INTEGER;if(o<0)return l.AMOUNT_NOT_NEGATIVE;if(o<n||o>s){const E=t(n.toString()),g=t(s.toString());return l.AMOUNT_RANGE(E,g)}return!0},ge=(e,r)=>{const t=r(e);if(!t)return l.EXPIRE_REQUIRED;if(t.length!==4)return l.EXPIRE_FORMAT;const n=parseInt(t.slice(0,2),10);if(n<1||n>12)return l.EXPIRE_MONTH_INVALID;const s=parseInt(t.slice(2),10),u=new Date,i=u.getFullYear()%100,o=u.getMonth()+1;return s<i||s===i&&n<o?l.EXPIRE_EXPIRED:!0},he=e=>{const r=e.replace(/\D/g,"");return r?r.length<3?l.CVV_MIN:!0:l.CVV_REQUIRED},P=(e,r={})=>{const{showCurrency:t=!1,currency:n="₽"}=r;if(!e)return"";const s=e.toString().replace(/\s/g,"").replace(".",","),[u,i=""]=s.split(","),o=s.endsWith(","),E=u.replace(/\D/g,"");if(!E)return"";let f=(E.replace(/^0+/,"")||"0").replace(/\B(?=(\d{3})+(?!\d))/g," ");const a=i.replace(/\D/g,"").slice(0,2);return o&&!a?f+=",":a&&(f+=`,${a}`),t?`${n} ${f}`:f},w=(e,r={})=>{const{currency:t="₽"}=r;if(!e)return"";let n=e.replace(t,"").trim();if(n=n.replace(/\s/g,""),n=n.replace(".",","),n=n.replace(/[^0-9,]/g,""),!n)return"";const s=n.split(","),i=(s[0]||"0").replace(/^0+/,"")||"0";let o="";return s.length>1&&(o=s[1].replace(/\D/g,"").slice(0,2)),s.length>1&&n.endsWith(",")&&!o?`${i},`:o?`${i},${o}`:i},Ve=(e,r={})=>P(e.toString(),r),Ee=(e,r={})=>{const t=w(e,r);if(!t)return NaN;const n=t.replace(",","."),s=parseFloat(n);return Number.isFinite(s)?s:NaN},ve=e=>e.replace(/\D/g,"").slice(0,4),Te=e=>{const r=e.replace(/\D/g,"").slice(0,4);return r.length<2?r:r.length===2?`${r} / `:`${r.slice(0,2)} / ${r.slice(2)}`},Re=(e=0,r=1/0,t=!0)=>[n=>!n||!n.trim()?t?l.AMOUNT_REQUIRED:!0:pe(n,w,P,e,r)],Ie=Re(1,1e6,!0),_e=[e=>e?de(e)?!0:l.EMAIL_INVALID:l.EMAIL_REQUIRED],ye=[e=>e?e.length<10?l.DESCRIPTION_MIN:e.length>200?l.DESCRIPTION_MAX:!0:l.DESCRIPTION_REQUIRED],Se=[me],Ae=[e=>ge(e,ve)],Fe=[he],S=(e,r)=>{for(const t of r){const n=t(e);if(typeof n=="string")return n}return!0},ke=e=>{const r={},t=S(e.amount,Ie);t!==!0&&(r.amount=t);const n=S(e.email.trim(),_e);n!==!0&&(r.email=n);const s=S(e.description.trim(),ye);return s!==!0&&(r.description=s),Object.keys(r).length>0?{valid:!1,errors:r}:{valid:!0,data:{amount:Ee(e.amount),email:e.email.trim(),description:e.description.trim()}}};export{$e as F,be as S,Ne as a,Se as b,Re as c,ye as d,_e as e,P as f,ve as g,Te as h,Ae as i,Fe as j,Ve as k,w as p,ke as v};
